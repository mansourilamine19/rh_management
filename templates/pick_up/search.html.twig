<a class="btn btn-info btn-sm" href="#" onclick='printEtiquette();'>
    <i class="fas fa-print"> 
        Selectionner colis à imprimer
    </i>
</a>

<a class="btn btn-danger btn-sm" href="#" onclick='deletePickUps();'>
    <i class="fas fa-trash"> 
        Supprimer des colis
    </i>
</a>
<table id="example2" class="table table-bordered table-hover">
    <thead>
        <tr>
            <th>Id</th>
            <th><input name="select_all" value="1" id="example-select-all" type="checkbox" /></th>
            <th>Code à barre</th>
            <th>Désignation</th>
            <th>Agence expédition</th>
            <th>Agence destination</th>
            <th>Infos client</th>
            <th>Prix</th>
            <th>Status colis</th>
            <th>Date de création</th>
            <th>Date de modification</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for pick_up in items %}
            <tr>
                <td>{{ pick_up.id }}</td>
                <td><input type="checkbox" name="barCode[]" value="{{ pick_up.barCode }}" id="pick_up_{{ pick_up.barCode }}"></td>
                <td>{{ pick_up.barCode }}</td>
                <td>{{ pick_up.designation }}</td>
                <td>{{ pick_up.agencyPickUp.name }}</td>
                <td>{{ pick_up.agencyDestination.name }}</td>
                <td>
                    <strong>{{ pick_up.fullName }}</strong> <br> 
                    {{ pick_up.tel }}***{{ pick_up.tel2 }} <br>
                    {{ pick_up.adresse }} {{ pick_up.locality.name }} : {{ pick_up.locality.city.name }}: {{ pick_up.locality.city.region.name }}
                </td>
                <td>{{ pick_up.price }}</td>
                <td>
                    {% if 'RETURN' in pick_up.status %}
                        <button type="button" class="btn btn-danger btn-xs">{{ pick_up.status|trans }}</button>
                    {% else %}
                        <button type="button" class="btn btn-info btn-xs">{{ pick_up.status|trans }}</button>
                    {% endif %}
                </td>
                <td>
                    {% if pick_up.createdAt is not null %}
                        {{ pick_up.createdAt|date("d/m/Y h:i:s") }} </td>
                    {% endif %}
                <td>
                    {% if pick_up.updatedAt is not null %}
                        {{ pick_up.updatedAt|date("d/m/Y h:i:s") }}
                    {% endif %}
                </td>
                <td>
                    {#                    
                     <a class="btn btn-info btn-sm" href="#" onclick=print({{ pick_up.id }})>
                         <i class="fas fa-print"> 
                         </i>
                     </a>
                     #} 
                    {% if pick_up.printed == false %}
                        <a class="btn btn-success btn-sm" href="{{ path('app_pick_up_edit', {'id': pick_up.id}) }}">
                            <i class="fas fa-edit">
                            </i>
                        </a>
                    {% endif %}
                    {% if app.user.role == "ROLE_SHIPPER" %}
                        <a class="btn btn-info btn-sm" href="{{ path('app_shipper_pick_up_history', {'id': pick_up.id}) }}">
                            <i class="fas fa-history">
                            </i>
                        </a>
                    {% elseif app.user.role == "ROLE_ADMIN" %}
                        <a class="btn btn-info btn-sm" href="{{ path('app_admin_pick_up_history', {'id': pick_up.id}) }}">
                            <i class="fas fa-history">
                            </i>
                        </a>
                    {% endif %}
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="10">no records found</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{{ include('partial/pagination.html.twig') }}

<!--------------------------------------------- Print bordereaux------------------------------>
<div style="display: none">
    {% for key,pick_up in items %}
        <page class="site-wrap js-site-wrap" id="etiquette_to_print_{{ pick_up.barCode }}" size="A4">
            <page size="A4">
                <div class="center">
                    <div class="container">
                        <div class="row">
                            <div class="listing listing--properties-list" style="width: 100%">

                                <div class="listing__main">
                                    <div class="form-property">

                                        <table style="width: 100%">
                                            <tr>
                                                <td style="width: 40%;">
                                                    <div style="font-size: 25px; margin-bottom: 0px; font-weight: bold;">Bordereau d'envoi</div>
                                                    <div style="text-align: left;letter-spacing: 6px;">               
                                                        <svg class="barcode"
                                                             {#    jsbarcode-format="upc"#}
                                                             jsbarcode-value="{{ pick_up.barCode }}"
                                                             jsbarcode-textmargin="0"
                                                             jsbarcode-fontoptions="bold">
                                                        </svg>
                                                    </div>
                                                </td>
                                                <td style="width: 20%;font-size: 30px; font-weight: bold; text-align: center">
                                                    {{ pick_up.agencyDestination.code }}<br>
                                                    {{ pick_up.agencyDestination.name }}
                                                </td>
                                                <td style="width: 40%;text-align: center"><table style="width: 100%;margin-top: 20px;margin-bottom: 5px;">
                                                        <tr>
                                                            <td style="width: 10%"></td>
                                                            <td style="font-size: 17px; padding: 5px;text-align: left;">

                                                                <div><b> Nom :</b> {{ pick_up.createdBy.fullName }}</div>

                                                                <div><b>Expéditeur : {{ pick_up.createdBy.shipper.namePage }}</b></div>
                                                                <div><b>Adresse : </b> {{ pick_up.createdBy.shipper.adresse }}</div>
                                                                <div><b>Tél. : </b> {{ pick_up.createdBy.tel }}</div>

                                                                <div><b>M/F : </b> {{ pick_up.createdBy.shipper.vatCode }}</div>

                                                                <div><b>Code Agence : </b> {{ pick_up.agencyPickUp.code }}</div>
                                                            </td>
                                                            <td style="width: 20%"></td>
                                                        </tr>
                                                    </table></td>
                                            </tr>
                                        </table>
                                        <table style="width: 100%">
                                            <tr>
                                                <td style="width: 10%;"></td>
                                                <td style="width: 80%"><div style="text-align: center;font-size: 20px;border: 1px solid #000;padding-left: 0px;margin-left: 0px;font-weight: bold;margin-top: 3px;margin-bottom: 3px;">
                                                        BON DE LIVRAISON N°  {{ pick_up.invoiceNumber }}
                                                    </div></td>
                                                <td style="width: 10%;text-align: center"></td>
                                            </tr>
                                        </table>

                                        <table style="width: 100%;margin-top: 20px;margin-bottom: 5px;">
                                            <tr>
                                                <td style="width:30%">Date BLF : {{ pick_up.createdAt|date("m/d/Y h:i:s") }}

                                                </td>
                                                <td style="font-size: 17px; border: 1px solid #000; padding: 5px;">
                                                    <div><b>NOM DE DESTINATAIRE:</b> {{ pick_up.fullName }}</div>
                                                    <div><b>ADRESSE:</b>{{ pick_up.adresse }} {{ pick_up.locality.name }} : {{ pick_up.locality.city.name }}: {{ pick_up.locality.city.region.name }}
                                                    </div>
                                                    <div><b>TELEPHONE:</b> {{ pick_up.tel }}***{{ pick_up.tel2 }}</div>
                                                </td>
                                                <td style="width: 5%"></td>
                                            </tr>
                                        </table>


                                        <table border="1" style="width: 100%;margin-top: 20px;margin-bottom: 5px;font-size: 15px;">
                                            <tr>
                                                <th style="width: 60%; text-align: center">Désignation</th>
                                                <th style="width: 10%;text-align: center">Nombre d'article</th>

                                                <th style="width: 15%; text-align: center">Montant Total</th>
                                            </tr>
                                            <tr>
                                                <td style="padding: 10px"> {{ pick_up.designation }}<br>
                                                </td>
                                                <td style="padding: 10px; text-align: center">{{ pick_up.numberItem }}
                                                </td> 
                                                <td style="padding: 10px; text-align: center">{{ pick_up.price|number_format(3, ',', ' ') }} DT
                                                </td>
                                            </tr>
                                        </table>

                                        <div style="text-align: right">
                                            <table border="1" style="width: 50%;margin-top: 2px;margin-bottom: 2px; font-size: 20px">
                                                <tr>
                                                    <td>Total en TTC</td>
                                                    <td>{{ pick_up.price|number_format(3, ',', ' ') }} DT</td>
                                                </tr>
                                            </table>
                                            <table border="1" style="width: 100%;margin-top: 20px;margin-bottom: 5px; font-size: 20px">
                                                <tr>
                                                    <td> {{ pick_up.paymentMethod | trans }} </td>
                                                    <td>Ouvrir le colis : {{ pick_up.openPack ? 'Oui' : 'Non' }}</td>
                                                </tr>
                                            </table>

                                            <div style="text-align: center; font-size: 20px;font-weight: bold; color:red">
                                                {% if pick_up.exchange == true  %}
                                                    COLIS ECHANGE
                                                {% endif %}
                                            </div>
                                            <br>
                                            <br>
                                            <br>
                                            <br>
                                            <br>
                                            <div style="text-align: center;font-size: 15px;margin-top: 0rem;">
                                                Société de Livraison : Navex Delivery<br>
                                                Adresse : Rue de l'Energie Atomique, Charguia 1 Tunis<br>
                                                MF : 1813348F
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                </div>
            </page>
        </page>
    {% endfor %}
</div>
<div id="print_etiquette">
</div>
<!--------------------------------------------- END Print bordereaux------------------------------>
